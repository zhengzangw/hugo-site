---
title: WiFi
date: 2019-01-28
tags: [notes, network]
weight: 5
---

# IEEE 802.11 (无线局域网,WiFi)

[参考资料：知乎](https://www.zhihu.com/people/edward_xu/posts?page=2)

| 术语                            |                                                                          |
| ------------------------------- | ------------------------------------------------------------------------ |
| 控制模块(CM)                    | 含有网桥/路由器功能，无线局域网接口                                      |
| 用户模块(UM)                    |                                                                          |
| 接入点(AP)                      | 任何具有站点功能并能向建立连接的站点提供经过无线媒体及接入分发系统的实体 |
| 基本服务集(BSS)                 | 单个协调功能所控制的站点集合                                             |
| 协调功能(coordination function) | 判断在BSS内运行的节点何时允许传输，何时能够接收 PDU 的逻辑功能           |
| 分发系统(DS)                    | 连接多个BSS以及综合局域网，形成ESS                                       |
| 扩展服务集(ESS)                 |                                                                          |
| MPDU                            | MAC协议数据单元                                                          |
| MSDU                            | MAC服务数据单元                                                          |
| 站点(STA)                       | 任何包含了 IEEE 802.11 MAC层和物理层的设备                               |
| WiFi联盟                        | Wireless Fidelity                                                        |

| 功能       | 服务                     |
| ---------- | ------------------------ |
| 分发报文   | 分发，综合，MSDU交付     |
| 关联       | 关联，重建关联，取消关联 |
| 接入与保密 | 鉴别，取消鉴别，保密     |

## IEEE 802.11 MAC层

### 分布式协调功能(DCF)

低端子层

* CSMA/CA
* 子模式(原子性)
  * 两帧交换：(源)数据帧，(终)ACK
  * 四帧交换（解决隐藏终端问题）：(源)RTS，(终)CTS，(源)数据帧，(终)ACK
  * threshold 控制模式转换：采用小的数据包碰撞，来避免大的数据包碰撞（如 2347Bytes）

### 点协调功能(PCF)

可选子层，基本无产品

* 中央轮询主控器（点协调器）进行轮询，与 DCF 兼容工作

### MAC 帧

| 帧控制 | 持续时间 | Address1 | Address2 | Address3 | 序号控制 | Address4 | QoS 控制 | 高吞吐控制 | 帧主体 | FCS |
| ------ | -------- | -------- | -------- | -------- | -------- | -------- | -------- | ---------- | ------ | --- |
| $2*8$  | $1*8$    | $6*8$    | $6*8$    | $6*8$    | $2*8$    | $6*8$    |          |            |        |     |

帧控制：Protocal(2)+Type(2)+Subtype(4)+Flag(8)

## IEEE 802.11 物理层

| 标准     | 802.11a | 802.11b      | 802.11g   | 802.11n    | 802.11ac   | 802.11ad |
| -------- | ------- | ------------ | --------- | ---------- | ---------- | -------- |
| 年份     | 1999    | 1999(已淘汰) | 2003      | 2000       | 2012       | 2014     |
| 最大速率 | 54Mbps  | 11Mbps       | 54Mbps    | 65~600Mbps | 78~2.1Mbpa | 6.76     |
| 频段     | 5GHz    | 2.4GHz       | 2.4GHz    | 2.4/5GHz   | 5GHz       | 60GHz    |
| 技术     | DSSS    | OFDM         | DSSS,OFDM | OFDM       | SC-OFDM    | SC-OFDM  |

## WiFi 加密

* WEP(IEEE 802.11) = RC4 + CRC32
* WPA(WiFi) = (802.1x + EAP)/Pre-shared Key + TKIP + MIC
* WPA2(802.11i) = (802.1x + EAP)/Pre-shared Key + AES + CCMP
* EAP: 算法架构
  * LEAP
  * MD5
  * TTLS
* 数据传输加密算法：TKIP, AES
* 数据完整性编码校验算法：MIC, CCMP
* WPA-PSK 四次握手

# IEEE 802.16 (WiMAX,固定宽带无线接入,无线城域网)

美国(Intel)提出，被接纳为3G第四个标准，韩国台湾相继放弃，仅日本在用(wimax2+)

# 蓝牙

提供通用的短距离无线通信能力，两个蓝牙设备在10m范围内最高720kbps  
wifi的主要作用是取代网线，蓝牙的主要作用是取代数据线  
IEEE 802.15 无线个人局域网(WPANs)，IEEE 802.15.1 为蓝牙协议，现不在使用  
蓝牙技术联盟（SIG）维护技术标准

## 协议体系结构

![蓝牙协议栈](https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike92%2C5%2C5%2C92%2C30/sign=77da218f692762d09433acedc185639f/ae51f3deb48f8c544ad85b8330292df5e0fe7f17.jpg)

* 微网(piconet)：最多8台设备，同一区域可共存10微网
* 分布网：一个设备科同时为主站或从站
* 蓝牙射频（蓝牙无线电）：2.4GHz
* 蓝牙基带
  * 跳频(FH)：FH-TDD-TDMA, FH-CDMA
  * 物理链路
    * 同步面向连接(SCO)：传输有时限的数据(如音频)
    * 异步无连接(ACL)
    * 分组格式：接入码(72)+首部(54)+有效载荷(0~2745)
    * 纠错
      * 1/3编码率 FEC
      * 2/3编码率 FEC
      * ARQ
* 蓝牙音频
  * 脉冲编码调制(PCM)
  * 连续可变斜率增量(CVSD)
* 逻辑链路控制与自适应协议(L2CAP)：提供无连接与面向连接
* 服务发现协议(SDP):建立连接
* 电缆替代协议(RFCOMM)：提供虚拟串口
